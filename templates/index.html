<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blockchain Certificate Verification</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>Blockchain Certificate Verification</h1>

        <h2>Publish Certificate</h2>
        <form id="publish-form">
            <input type="text" id="awardee_name" placeholder="Awardee Name" required>
            <input type="text" id="certificate_name" placeholder="Certificate Name" required>
            <input type="text" id="certificate_code" placeholder="Certificate Code" required>
            <button type="submit">Publish Certificate</button>
        </form>
        
        <h2>Verify Certificate</h2>
        <form id="verify-form">
            <input type="text" id="verify_certificate_hash" placeholder="Certificate Hash" required>
            <button type="submit">Verify Certificate</button>
        </form>

        <div id="response"></div>
    </div>

    <script>
        // Handle Publish Certificate Form
        document.getElementById('publish-form').addEventListener('submit', async (event) => {
            event.preventDefault();

            const awardeeName = document.getElementById('awardee_name').value;
            const certificateName = document.getElementById('certificate_name').value;
            const certificateCode = document.getElementById('certificate_code').value;

            const responseDiv = document.getElementById('response');

            const data = {
                awardee_name: awardeeName,
                certificate_name: certificateName,
                certificate_code: certificateCode
            };

            const res = await fetch('/publish', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });

            const result = await res.json();

            if (res.ok) {
                responseDiv.innerHTML = `Certificate Published Successfully!<br> Certificate Hash: ${result.certificate_hash}<br> Transaction Hash: ${result.transaction_hash}`;
            } else {
                responseDiv.innerHTML = `Error: ${result.error}`;
            }
        });

        // Handle Verify Certificate Form
        document.getElementById('verify-form').addEventListener('submit', async (event) => {
            event.preventDefault();

            const certificateHash = document.getElementById('verify_certificate_hash').value;

            const responseDiv = document.getElementById('response');

            const res = await fetch(`/verify?certificate_hash=${certificateHash}`);
            const result = await res.json();

            if (res.ok) {
                if (result.verified) {
                    responseDiv.innerHTML = `Certificate Verified!<br> Awardee: ${result.certificate.awardee_name}<br> Certificate Name: ${result.certificate.certificate_name}`;
                } else {
                    responseDiv.innerHTML = "Certificate not found or invalid.";
                }
            } else {
                responseDiv.innerHTML = `Error: ${result.error}`;
            }
        });
    </script>
</body>
</html>
